---
title: "Plastic Pollution Around the World"
output:
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    theme: flatly
---

```{=html}
<script src="https://kit.fontawesome.com/805d72eba7.js" crossorigin="anonymous"></script>
```

------------------------------------------------------------------------

```{r setup, include=FALSE}
library(flexdashboard)
library(fontawesome)
library(tidyverse)
library(shiny)
library(htmltools)
library(bslib)
library(colorspace)
library(dplyr)
library("DT")
library(sf)
library(viridis)
library(leaflet)
library(plotly)
library(DT)
library(ggthemes)
library(maptools)
library(rnaturalearth)
library(sp)
library(broom)
library(cshapes)
library(simplevis)
library(palmerpenguins)
library(scales)
library(purrr)
```

Description of flexdashboard

------------------------------------------------------------------------

## Value Boxes {data-width = 1000}

```{r include = FALSE}
# Reading and cleaning data

plastics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-26/plastics.csv')
plastics_new <- plastics %>% 
  select("country","empty", "hdpe", "ldpe", "o", "pet", "pp", "ps", "pvc",
         "grand_total")

# Creating a new data frame which includes counts of plastic types and the total plastics collected
plastics_version <- 
  plastics_new %>%
  group_by(country) %>%
  summarize(EMPTY = sum(empty),
            HDPE = sum(hdpe),
            LDPE = sum(ldpe),
            OTHERS = sum(o),
            PET = sum(pet),
            PP = sum(pp),
            PS = sum(ps),
            PVC = sum(pvc),
            grand_total = sum(grand_total),
total = sum(EMPTY, HDPE, LDPE, OTHERS, PET, PP, PS, PVC, na.rm = TRUE)) %>% 
  filter(country != c("NIGERIA")) %>% 
  filter(country != c("ECUADOR")) %>% 
  filter(country != c("EMPTY")) %>% 
  pivot_longer(HDPE:PVC, names_to = "Plastic type",
               values_to = "count")

# Establishing color pallet
rainbow_hcl(n = 7)
```

### Others

```{r}
valueBox(1, caption = "<b>Others<b>", color = "#E495A5", icon = "fa-compact-disc")
```

### PET

```{r}
valueBox(2, caption = "Polyethylene Terephthalate <b>(PET)<b>", color = "#CEA472", icon = "fa-bottle-water")
```

### LDPE

```{r}
valueBox(3, caption = "Low-Density Polyethlyene <b>(LDPE)<b>", color = "#9CB469", icon = "fa-bag-shopping")
```

### PP

```{r}
valueBox(4, caption = "Polypropylene <b>(PP)<b>", color = "#56BD96", icon = "fa-suitcase-rolling")
```

### HDPE

```{r}
valueBox(5, caption = "High-Density Polyethlyene <b>(HDPE)<b>", color = "#46BAC8", icon = "fa-jug-detergent")
```

### PS

```{r}
valueBox(6, caption = "Polystyrene <b>(PS)<b>", color = "#99A9E2", icon = "fa-utensils")
```

### PVC

```{r}
valueBox(7, caption = "Polyvinyl Chloride <b>(PVC)<b>", color = "#D497D3", icon = "fa-sheet-plastic")
```

## Row {.tabset .tabset-fade}

### Plastic Polution Leaflet with Distribution Popups

filler

```{r}

```

### Distribution of Plastic Types by Country

filler

```{r}

```

### Plastic Types by Country Data Table

filler

```{r echo = FALSE}
plastics_new <- plastics %>%
  select("country","empty", "hdpe", "ldpe", "o", "pet", "pp", "ps", "pvc",
         "grand_total")
plastics_version <-
  plastics_new %>%
  group_by(country) %>%
  summarize(EMPTY = sum(empty),
            HDPE = sum(hdpe),
            LDPE = sum(ldpe),
            OTHERS = sum(o),
            PET = sum(pet),
            PP = sum(pp),
            PS = sum(ps),
            PVC = sum(pvc),
            grand_total = sum(grand_total),
            total = sum(EMPTY, HDPE, LDPE, OTHERS, PET, PP, PS, PVC, na.rm = TRUE)) %>%
  filter(country != c("NIGERIA")) %>%
  filter(country != c("ECUADOR")) %>%
  filter(country != c("EMPTY")) %>%
  pivot_longer(HDPE:PVC, names_to = "Plastic type",
               values_to = "count") %>% 
  pivot_wider(names_from = "Plastic type",
                      values_from = "count")
plastics_version <- plastics_version %>% 
  select("country","HDPE","LDPE","PET","OTHERS","PP","PS","PVC","total") %>% 
  rename ('High density polyethylene' = HDPE,
         'Low density polyethylene' = LDPE,
         'Polyester plastic' = PET,
         'Polypropylene' = PP,
         'Polystyrene' = PS,
         'Polyvinyl Chloride' = PVC, 
         'Other plastic'= OTHERS,
         'Total'= total)
datatable(plastics_version)
```
